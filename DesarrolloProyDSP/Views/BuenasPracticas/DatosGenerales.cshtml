@*@model DesarrolloProyDSP.Models.Usuario.UsuarioViewModel*@
@model Tuple<DesarrolloProyDSP.Models.Global.CEOViewModel, DesarrolloProyDSP.Models.ModuloBP.EjeViewModel, DesarrolloProyDSP.Models.Global.MunicipioViewModel, DesarrolloProyDSP.Models.ModuloBP.FuncionDesarrolloViewModel>

@{
    Layout = null;
    ViewBag.Title = "DatosGenerales";
}

<!DOCTYPE html>

<html>
<head>

    <title>DatosGenerales</title>
    @*<meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="keywords" content="Hablar sobre la plataforma SEG" />
        <script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <!-- <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all">-->
        <link href="@Url.Content("~/css/bootstrap.css")" rel="stylesheet" type="text/css" media="all">
        <!-- Custom Theme files -->
        <!--<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />-->
        <link href="@Url.Content("~/css/style.css")" rel="stylesheet" type="text/css" media="all">
        <!--js-->
        <script src="@Url.Content("~/Scripts/jquery-2.1.1.min.js")"></script>
        <!--icons-css-->
        <link href="@Url.Content("~/css/font-awesome.css")" rel="stylesheet">
        <link href="@Url.Content("~/css/panel.css")" rel="stylesheet">
        <link href="@Url.Content("~/material-design-iconic-font/css/materialdesignicons.min.css")" rel="stylesheet">

        <!--Google Fonts-->


        <link href='//fonts.googleapis.com/css?family=Carrois+Gothic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Work+Sans:400,500,600' rel='stylesheet' type='text/css'>

        <!--button css-->
        <link href="@Url.Content("~/css/demo-page.css")" rel="stylesheet" media="all">
        <link href="@Url.Content("~/css/hover.css")" rel="stylesheet" media="all">

        <!--static chart-->
        <script src="@Url.Content("~/Scripts/Chart.min.js")"></script>
        <!--//charts-->
        <script src="@Url.Content("~/Scripts/sidebarmenu.js")"></script>
        <!-- geo chart -->
        <script src="//cdn.jsdelivr.net/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script>window.modernizr || document.write('<script src="lib/modernizr/modernizr-custom.js"><\/script>')</script>
        <!--<script src="lib/html5shiv/html5shiv.js"></script>-->
        <!--pop up strat here-->
        <script src="@Url.Content("~/Scripts/jquery.magnific-popup.js")" type="text/javascript"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $('.popup-with-zoom-anim').magnificPopup({
                    type: 'inline',
                    fixedContentPos: false,
                    fixedBgPos: true,
                    overflowY: 'auto',
                    closeBtnInside: true,
                    preloader: false,
                    midClick: true,
                    removalDelay: 300,
                    mainClass: 'my-mfp-zoom-in'
                });

            });
        </script>

        <!-- agregar autor  -->
        <!--pop up end here-->
        <!--skycons-icons-->
        <script src="@Url.Content("~/Scripts/skycons.js")"></script>*@
    <!--//skycons-icons-->
    @Html.Partial("../ViewPartialPrincipales/_ScriptsLink")
</head>
<body>
    @using (Html.BeginForm("DatosGenerales", "BuenasPracticas", FormMethod.Post, new { id = "formNuevaBP", name = "formNuevaBP" }))
    {

        <div class="page-container">
            <div class="left-content">
                <div class="mother-grid-inner">
                    <!--header start here-->
                    @*<div class="header-main">

                <div class="row header-content">

                    <div>

                        <a href="http://www.seg.guanajuato.gob.mx">
                            <img src=@Url.Content("~/image/editable_logo.png") width="130" alt="SEG" />

                        </a> 	 <div style="margin-top: -60px; color: #FFFFFF" align="center" class="chit-chat-heading" id="titulo">
                            <p>Permanencia Escolar en la Educación Media Superior</p><br>

                        </div>


                        <nav id="main-nav-wrap" class="main-nav-wrap">
                            <ul class="main-navigation">
                                <li><a href="index" title="">Inicio</a></li>
                                <li class="has-children">
                                    <a href="Administrador/category.html" title="">Recursos Educativos</a>
                                    <!--SUB MENU  <ul class="sub-menu">
                                       <li><a href="category.html">Wordpress</a></li>
                                       <li><a href="category.html">HTML</a></li>
                                       <li><a href="category.html">Photography</a></li>
                                       <li><a href="category.html">UI</a></li>
                                       <li><a href="category.html">Mockups</a></li>
                                       <li><a href="category.html">Branding</a></li>
                                    </ul>-->
                                </li>
                                <li class="has-children">
                                    <a href="@Url.Action("Practicas","BuenasPracticas")" title="">Buenas pr&aacute;cticas</a>
                                    <!--SUB MENU    <ul class="sub-menu">
                                       <li><a href="single-video.html">Video Post</a></li>
                                       <li><a href="single-audio.html">Audio Post</a></li>
                                       <li><a href="single-gallery.html">Gallery Post</a></li>
                                       <li><a href="single-standard.html">Standard Post</a></li>
                                    </ul>-->
                                </li>
                                <li><a href="Administrador/style-guide.html" title="">Becas y Apoyos</a></li>
                                <li><a href="ActividadesA.html" title="">Actividades Acad&eacute;micas</a></li>
                                <li><a href="Administrador/contact.html" title="">Contacto</a></li>
                                <li class="hvr-icon-buzz-out" style="background:none; color: #FFFCFC; height: auto; margin-top: -13px; margin-bottom: -20px"><a href="@Url.Action("CerrarSesion","BuenasPracticas")">Cerrar sesión</a></li>

                            </ul>
                        </nav> <!-- end main-nav-wrap -->



                    </div>
                </div>





                <div class="clearfix"> </div>
            </div>*@
                    @Html.Partial("../ViewPartialPrincipales/_Header")
                    <div class="clearfix"> </div>
                </div>
                <!--heder end here-->
                <!-- script-for sticky-nav -->
                <script>
                    $(document).ready(function () {
                        var navoffeset = $(".header-main").offset().top;
                        $(window).scroll(function () {
                            var scrollpos = $(window).scrollTop();
                            if (scrollpos >= navoffeset) {
                                $(".header-main").addClass("fixed");
                            } else {
                                $(".header-main").removeClass("fixed");
                            }
                        });

                    });
                </script>
                <!-- /script-for sticky-nav -->
                <!--inner block start here-->


                <div class="inner-block" style="margin-top: -20px">
                    <!--market updates updates-->


                    <div class="clearfix"> </div>








                    <!--pop-up-grid-->
                    <!--pop-up-grid-->




                    <div class="chit-chat-layer1 ">

                        <div class="col-md-2 chit-chat-layer1-left ">
                            <br>


                        </div>

                        <div class="col-md-8 chit-chat-layer1-left ">
                            <div class="work-progres ">

                                <div class="table-responsive">




                                    <div class="form-style-10">

                                        <h1>Crear Nueva Buena Pr&aacute;ctica</h1>
                                        <form>


                                            <div class="section"><span>1</span>Título de la Buena Pr&aacute;ctica</div>
                                            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                            <div class="inner-wrap">
                                                <label>Escriba un nombre corto y conciso que dé cuenta del contenido de la Práctica Innovadora</label>
                                                @if (Request.Cookies["CookieIdTituloBP"] == null)
                                                {
                                                    <input name="txtTitulo" id="txtTitulo" type="text" maxlength="100" class="bio" required />
                                                }
                                                else
                                                { <input name="txtTitulo" id="txtTitulo" type="text" maxlength="100" value="@Session["Titulo"].ToString()" class="bio" disabled="true" />}




                                                <label>
                                                    Eje temático en el que se desea registrar la buena práctica.

                                                    <select name="selectEje" id="selectEje">
                                                        @foreach (var item in Model.Item2.listaEjes)
                                                        {
                                                            if (Model.Item2.nombre == item.nombre)
                                                            {
                                                                <option id="@item.idEje" selected>@item.nombre</option>
                                                            }
                                                            else
                                                            {
                                                                <option id="@item.idEje">@item.nombre</option>
                                                            }
                                                        }
                                                    </select>
                                                </label>


                                            </div>

                                            <div class="section"><span>2</span>Sobre el desarrollo de la Buena Pr&aacute;ctica</div>
                                            <div class="inner-wrap">
                                                <label>
                                                    Municipio
                                                    <select name="selectMunicipio" id="selectMunicipio">
                                                        @foreach (var item in Model.Item3.listMunicipios)
                                                        {
                                                            if (Model.Item3.nombreMunicipio == item.nombreMunicipio)
                                                            {
                                                                <option id="@item.idMunicipio" selected>@item.nombreMunicipio</option>
                                                            }
                                                            else
                                                            {
                                                                <option id="@item.idMunicipio">@item.nombreMunicipio</option>
                                                            }

                                                        }
                                                    </select>
                                                </label>
                                                <br>

                                                <div class="form-group row">
                                                    <div class="col-xs-3">
                                                        <label for="ex1">Clave</label>
                                                        @*<select name="ClaveCEO" id="ClaveCEO" class="bio" style="width: auto" onchange="NombreCEO()">
                                                    @foreach (var item in Model.Item1.listCEO)
                                                    {
                                                        if (Model.Item1.claveCentroTrabajo==item.claveCentroTrabajo)
                                                        {<option id = "@item.idCEO" selected> @item.claveCentroTrabajo </option >}
                                                       else { <option id="@item.idCEO">@item.claveCentroTrabajo</option>}

                                                    }
                                                </select>*@
                                                        <!--
                                                Código html Ceci
                                            -->
                                                        <input type="text" id="escCCT" name="escCCT" value="@Model.Item1.claveCentroTrabajo" onfocusout="ValidarCCT()" min="10" required />
                                                    </div>
                                                    <div class="col-xs-9">
                                                        <label>
                                                            Nombre del Centro de trabajo <br>

                                                            *donde se realiza la Pr&aacute;ctica <input class="form-control bio" name="nombreCEO" id="nombreCEO" type="text" disabled="true" required />
                                                        </label>
                                                    </div>

                                                </div>

                                                <label>Función desde la que desarrolló la Pr&aacute;ctica </label>
                                                <select name="funcion" id="funcion" class="bio">
                                                    @foreach (var item in Model.Item4.listFunciones)
                                                    {
                                                        if (Model.Item4.nombreFunc == item.nombreFunc)
                                                        {
                                                            <option id="@item.idFuncionD" selected>@item.nombreFunc</option>
                                                        }
                                                        else
                                                        {
                                                            <option id="@item.idFuncionD">@item.nombreFunc</option>
                                                        }

                                                    }
                                                </select>

                                                <script type="text/javascript">
                                                    //auto expand textarea
                                                    function adjust_textarea(h) {
                                                        h.style.height = "20px";
                                                        h.style.height = (h.scrollHeight) + "px";
                                                    }
                                                </script>


                                            </div>






                                            <div class="compose-block" style="background: none">

                                                @if (Request.Cookies["CookieIdTituloBP"] == null)
                                                {
                                                    <a style="width: 100%" onclick="RegistrarBP()">Crear</a>
                                                }
                                                else
                                                {
                                                    <a style="width: 100%" onclick="ActualizarDG()">Guardar cambios Datos Generales</a>
                                                }


                                            </div>


                                        </form>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="col-md-2 chit-chat-layer1-left ">
                            <br>


                        </div>

                        <div class="clearfix"> </div>
                    </div>


                </div>
                <!--inner block end here-->
                <!--copy rights start here-->
                @*<div class="copyrights">

            <img src=@Url.Content("~/image/gto.png") class="imgRedonda" style="display:inline" alt="GTO" width="100">

            <br><br>
            <p>SECRETAR&Iacute;A DE EDUCACI&Oacute;N DE GUANAJUATO</p>

            <p style="font-size: 12px">
                Pozuelos: Conjunto Administrativo Pozuelos S/N Guanajuato, Gto. (473) 735-1000
                Puentecillas: Carretera Guanajuato-Puentecillas km 9.5 Guanajuato, Gto. (473) 735-1200
                Profesiones: Carretera Guanajuato-Juventino Rosas km 6.5 Esq. Jazm&iacute;n, Col. Arroyo Verde (473) 10 20 200

                01 800 890 30 80
            </p>

            <a href="mailto:comunicacion_seg@seg.guanajuato.gob.mx?subject=Email%20Subject">comunicacion_seg@seg.guanajuato.gob.mx</a>





            <ul class="social-buttons" id="demo3">
                <li>
                    <a href="http://www.youtube.com/user/EducacionGuanajuato" class="brandico-youtube"><img src="http://hopedalebuilders.com/files/2018/01/youtube-icon-white.png" width="70%"></a>
                </li>
                <li>
                    <a href="https://www.facebook.com/pages/Secretar%C3%ADa-de-Educaci%C3%B3n-de-Guanajuato-SEG/340786939279382?ref=hl" class="brandico-facebook"><img src="https://amcboise.com/wp-content/uploads/2017/11/facebook.png" width="80%"></a>
                </li>
                <li>
                    <a href="https://twitter.com/ComunicacionSEG" class="brandico-twitter-bird"><img src="https://www.bh-bims.org/wp-content/uploads/2017/12/twitter-icon-white-e1513102680550.png" width="90%"></a>
                </li>


            </ul>

        </div>*@
                @Html.Partial("../ViewPartialPrincipales/_Footer")
                <!--COPY rights end here-->
            </div>
        </div>




        <div class="clearfix"> </div>

        <!--slide bar menu end here-->
        <!--scrolling js-->
        <script src="Administrador/js/jquery.nicescroll.js"></script>
        <script src="Administrador/js/scripts.js"></script>
        <!--//scrolling js-->
        <script src="Administrador/js/bootstrap.js"></script>
        <!-- mother grid end here-->
    }
    }

</body>
</html>

<script type="text/javascript">
   
    $(document).ready(function () {
        $.ajax({
        type: "POST",
        url: '@Url.Action("NameCEO", "BuenasPracticas")', // don't hard code url's
            data: { clavCEO: $('#escCCT').val()},
            success: function (data) // lowercase (not Success)
            {
                document.getElementById("nombreCEO").value = data;
            },
            error: function (data) {
                alert("Error con la obtencion del nombre de CEO.");
            }
        });
    });

    function RegistrarBP() {
        ////Validar que el campo de nombre y clave no esten vacios
        //if ($('#escCCT').val() == "" || $('#txtTitulo').val() == "")
        //    alert("Campos obligatorios vacíos.")
        //else
        //document.getElementById("formNuevaBP").submit();
        var tit = document.getElementById("txtTitulo").value;
        var e = document.getElementById("selectEje").value;
        var m = document.getElementById("selectMunicipio").value;
        var c = document.getElementById("escCCT").value;
        var f = document.getElementById("funcion").value;

        if (c == "" || c == null) {
            alert("CCT incorrecta o vacía.");
        }else {
            $.ajax({
                    url: "@Url.Action("DatosGenerales", "BuenasPracticas")",
                    method: "POST",
                    data: { titulo: tit, eje: e, municipio: m, ceo: c, funcion: f},
                    datatype: "json",
                    success: function () 
                    {
                        window.location.assign("RegistroBP");
                    }
                })
        }
    }

    function ValidarCCT() {
        var ct = document.getElementById("escCCT").value;
       $.ajax({
                    url: "@Url.Action("ValidarCCT", "BuenasPracticas")",
                    method: "POST",
                    data: { CCT: ct},
                    datatype: "json",
                    success: function (data) 
                    {
                        if (data != "True") {
                            alert("Clave CT incorrecta.");
                            document.getElementById("escCCT").value = "";
                            
                        } 
                        NombreCEO2();
                       
                        //document.getElementById("escCCT").value = "ERROR CCT";
                    }
                })
    }

    function NombreCEO2() {
        $.ajax({
        type: "POST",
        url: '@Url.Action("NameCEO", "BuenasPracticas")', // don't hard code url's
            data: { clavCEO: $('#escCCT').val()},
            success: function (data) // lowercase (not Success)
            {
                document.getElementById("nombreCEO").value = data;
            },
            error: function (data) {
                alert("Error con la obtencion del nombre de CEO.");
            }
        });
    }

    function ActualizarDG() {
        var tit = document.getElementById("txtTitulo").value;
        var e = document.getElementById("selectEje").value;
        var m = document.getElementById("selectMunicipio").value;
        var c = document.getElementById("escCCT").value;
        var f = document.getElementById("funcion").value;

        if (c == "" || c == null) {
            alert("CCT incorrecta o vacía.");
        }else {
            $.ajax({
                    url: "@Url.Action("ActualizarDG", "BuenasPracticas")",
                    method: "POST",
                    data: { titulo: tit, eje: e, municipio: m, ceo: c, funcion: f},
                    datatype: "json",
                    success: function () 
                    {
                        window.location.assign("RegistroBP");
                    }
                })
        }
        
                

    }
    
</script>