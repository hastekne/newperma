@model Tuple<DesarrolloProyDSP.Models.ModuloEvento.EventoViewModel, DesarrolloProyDSP.Models.ModuloEvento.FuncionParticipanteViewModel, DesarrolloProyDSP.Models.ModuloEvento.MesaEventoViewModel, DesarrolloProyDSP.Models.ModuloEvento.CampoEventoViewModel>

<link href="~/css/bienvenida.css" rel="stylesheet" type="text/css" media="all">
<!-- multiselector-->
<script src="~/Scripts/multi/jquery-3.4.1.min.js"></script>
<script src="~/Scripts/multi/jquery-3.4.1.min.js"></script>
<link rel="stylesheet" href="~/Scripts/multi/multiple-select.min.css">
<script src="~/Scripts/multi/multiple-select.min.js"></script>
<script src="~/Scripts/multi/multipleselect.js"></script>
<!-- multiselector fin-->
<!--pop up strat here-->
<script src="@Url.Content("~/Scripts/jquery.magnific-popup.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('.popup-with-zoom-anim').magnificPopup({
            type: 'inline',
            fixedContentPos: false,
            fixedBgPos: true,
            overflowY: 'auto',
            closeBtnInside: true,
            preloader: false,
            midClick: true,
            removalDelay: 300,
            mainClass: 'my-mfp-zoom-in'
        });

    });
</script>

<style>

    #Exitoso {
        background: white;
        padding: 10px 0 10px 0;
        text-align: left;
        max-width: 629px;
        margin: 40px auto;
        position: relative;
        text-align: center;
        height: 300px;
        border-radius: 5px;
    }

    .form-style-10 select {
        display: block !important;
        box-sizing: border-box !important;
        -webkit-box-sizing: border-box !important;
        -moz-box-sizing: border-box !important;
        width: 100% !important;
        padding: 8px !important;
        border-radius: 6px !important;
        -webkit-border-radius: 6px !important;
        -moz-border-radius: 6px !important;
        border: 2px solid #fff !important;
        box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33) !important;
        -moz-box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33) !important;
        -webkit-box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.33) !important;
    }
</style>



<div class="chit-chat-layer1 ">

    <div class="col-md-2 chit-chat-layer1-left ">



    </div>

    <div class="col-md-8 chit-chat-layer1-left ">
        <div class="work-progres ">

            <div class="table-responsive">

                <div class="blog-slider__Bienvenida" style="text-align: center; margin-top:-5px; margin-bottom: -30px; z-index: 0">Registro individual al evento</div>




                <div class="form-style-10" style="width: 720px">




                    <div class="Titulo_Eventos up" align="center"><textarea rows="3" maxlength="100" readonly="readonly" class="shadow-none">@Model.Item1.nombre</textarea></div>

                    <table width="100%">
                        <tbody>
                            <tr>
                                <td width="45%">
                                    @if (Model.Item4.CCT == true)
                                    {<div><label>CCT:<input maxlength="10" id="txtReiCCT" onkeypress="ValidarEnter('@Model.Item1.nombre')" type="text" required /></label></div>}
                                </td>
                                <td width="10%"></td>
                                <td width="45%">
                                    @if (Model.Item4.regionSEG == true)
                                    {<div><label>Región SEG:<input id="txtReiRegion" type="text" disabled /></label></div>}
                                </td>
                            </tr>
                            <tr>
                                <td width="45%">
                                    @if (Model.Item4.nombrePlantel == true)
                                    {<div><label>Nombre del Plantel:<input id="txtReiPlantel" type="text" disabled /></label></div>}
                                </td>
                                <td width="10%"></td>
                                <td width="45%">
                                    @if (Model.Item4.nivel == true)
                                    {<div><label>Nivel:<input id="txtReiNivel" type="text" disabled /></label></div>}
                                </td>
                            </tr>
                            <tr>
                                <td width="45%">
                                    @if (Model.Item4.municipio)
                                    {
                                        <div>
                                            <label>
                                                Municipio donde se realiza el evento:



                                                <input id="txtReiMuni" type="text" disabled />

                                            </label>

                                        </div>
                                    }
                                </td>
                                <td width="10%"></td>

                                <td width="45%">
                                    @if (Model.Item4.instiSubsis == true)
                                    {<div><label>Subsistema<input id="txtReiSubsis" type="text" disabled /></label></div>}
                                </td>
                            </tr>
                        </tbody>
                    </table>


                    @if (Model.Item4.CURP == true)
                    {
                        <div>
                            <label>CURP<input onfocusout="ValidaCurpLostFocus()" id="txtReiCURP" type="text" name="field1" required disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.nombre == true)
                    {
                        <div>
                            <label>Nombre<input id="txtReiNom" type="text" name="field1" required disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.apellidoPat == true)
                    {
                        <div>
                            <label>Primer Apellido <input id="txtReiPA" type="text" name="field1a" required disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.apellidoMat == true)
                    {
                        <div>
                            <label>Segundo Apellido <input id="txtReiSA" type="text" name="field1b" required disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.correoElectronico == true)
                    {
                        <div>
                            <label>Correo electr&oacute;nico <input id="txtReiEmail" type="email" onfocusout="ValidaEmail()" required disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.telefono == true)
                    {
                        <div>
                            <label>Telefono <input id="txtReiTel" onfocusout="ValidaTelER()" type="text" required onkeypress="return justNumbers(event);" maxlength="10" align="right" disabled /></label>
                        </div>
                    }
                    @if (Model.Item4.sexo == true)
                    {
                        <div>
                            <label>
                                Sexo <select id="cbxReiSexo" disabled>
                                    <option selected>Femenino</option>
                                    <option>Masculino</option>
                                </select>
                            </label>
                        </div>
                    }

                    @if (Model.Item4.funcion == true)
                    {
                        <div>
                            <label>
                                Funciones:


                                <select id="cbxReiFunc" style="border:none !important" disabled>
                                    @*disabled*@
                                    @foreach (var item in Model.Item2.listaFuncionPart)
                                    {
                                        <option> @item.nomFuncion</option>
                                    }

                                </select>
                            </label>
                        </div>
                    }

                    <br>

                    @if (Model.Item4.mesaTrabajo == true)
                    {
                        <div>
                            <label>
                                Mesa de trabajo:

                                <br>

                                <!-- Multiple Select -->

                                <select id="select1" class="text-box-dark" MULTIPLE>
                                    @foreach (var item in Model.Item3.listaMesasEvento)
                                    {
                                        <option value="@item.nombreMT"> @item.nombreMT </option>
                                    }


                                </select>
                            </label>
                        </div>
                    }










                    <div class="compose-block" style="background: none; width: 100%">
                        <div class="button-section compose compose-bottom" align="right">

                            <button id="PopUPErrorRegistroInd" onclick="RegistroIndividualParti('@Model.Item1.nombre')" class="popup-with-zoom-anim" @*href="#Exitoso"*@ tooltip="Registrar" style="width: 100%; text-align: center">REGISTRAR</button>
                            @*<button onclick="RegistroIndividualParti('@Model.Item1.nombre')" tooltip="Registrar" style="width: 100%; text-align: center">REGISTRAR</button>*@
                        </div>
                    </div>


                    <!--pop-up-grid LISTO-->
                    <div id="PopUpErrorRegistro" align="center">

                    </div>
                    @*<div id="popup">
                            <div id="Exitoso" class="mfp-hide">
                                <div class="pop_up">
                                    <div class="payment-online-form-left">
                                        <div>

                                            <div class="blog-slider swiper-container-fade swiper-container-horizontal">

                                                <div class="blog-slider__Error" style="text-align: center; margin-top:-30px; margin-bottom: -30px; z-index: 0;">¡Error de Registro!</div>
                                                <div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms; z-index: 0">



                                                    <br>

                                                    <div align="center" style="width:550px">


                                                        <div style="width:100%; text-align:center; " align="center">

                                                            <div class="blog-slider__title">Hubó un error en su registro al evento:</div>
                                                            <br>
                                                            <div class="blog-slider__text">El destino de la educación en México en tiempos del COVID-19</div>

                                                            <span class="blog-slider__code">Del 22 al 25 de Marzo de 2021</span>
                                                            <br>

                                                            <a href="#" class="blog-slider__button" tooltip="Volver a realizar el registro">Intente nuevamente</a><samp>         &shy; &shy;</samp><a href="registroMasivo.html" class="blog-slider__button2" tooltip="Regresar a eventos">Regresar</a>
                                                        </div>
                                                    </div>





                                                </div>

                                            </div>



                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>*@

                    <!--pop-up-grid-->



                </div>

            </div>
        </div>
    </div>
    <div class="col-md-2 chit-chat-layer1-rit">



    </div>
    <div class="clearfix"> </div>
</div>

<script>


            function ValidarEnter(nomE) {
                if (event.which == 13) {
                    var ct = document.getElementById("txtReiCCT").value;
                    ValidarCCTRI(nomE,ct);

                }
            }




            function ValidarCCTRI(nomE,ct) {

                $.ajax({
                    url: "@Url.Action("ValidarCCT", "Evento")",
                    method: "POST",
                    data: { CCT: ct, ne: nomE },
                    //datatype: "json",
                    success: function (data) {

                        if (data != "True") {
                            alert("Clave CT incorrecta.");
                            if (document.getElementById("txtReiCCT")) {
                                document.getElementById("txtReiCCT").value = "";
                                document.getElementById("txtReiCCT").focus();
                            }
                            if (document.getElementById("txtReiCCT"))
                                document.getElementById("txtReiCURP").disabled = true;
                            if (document.getElementById("txtReiNom"))
                                document.getElementById("txtReiNom").disabled = true;
                            if (document.getElementById("txtReiPA"))
                                document.getElementById("txtReiPA").disabled = true;
                            if (document.getElementById("txtReiSA"))
                                document.getElementById("txtReiSA").disabled = true;
                            if (document.getElementById("txtReiEmail"))
                                document.getElementById("txtReiEmail").disabled = true;
                            if (document.getElementById("txtReiTel"))
                                document.getElementById("txtReiTel").disabled = true;
                            if (document.getElementById("cbxReiSexo"))
                                document.getElementById("cbxReiSexo").disabled = true;
                            if (document.getElementById("cbxReiFunc"))
                                document.getElementById("cbxReiFunc").disabled = true;
                            if (document.getElementById("txtReiCURP"))
                                document.getElementById("txtReiCURP").value = "";
                            if (document.getElementById("txtReiRegion"))
                                document.getElementById("txtReiRegion").value = "";
                            if (document.getElementById("txtReiPlantel"))
                                document.getElementById("txtReiPlantel").value = "";
                            if (document.getElementById("txtReiNivel"))
                                document.getElementById("txtReiNivel").value = "";
                            if (document.getElementById("txtReiMuni"))
                                document.getElementById("txtReiMuni").value = "";
                            if (document.getElementById("txtReiSubsis"))
                                document.getElementById("txtReiSubsis").value = "";

                        } else {
                            //Habilitar Campos
                            // alert("correcto");
                            if (document.getElementById("txtReiCURP")) {
                                document.getElementById("txtReiCURP").focus();
                                document.getElementById("txtReiCURP").disabled = false;
                            }
                            if (document.getElementById("txtReiNom"))
                                document.getElementById("txtReiNom").disabled = false;
                            if (document.getElementById("txtReiPA"))
                                document.getElementById("txtReiPA").disabled = false;
                            if (document.getElementById("txtReiSA"))
                                document.getElementById("txtReiSA").disabled = false;
                            if (document.getElementById("txtReiEmail"))
                                document.getElementById("txtReiEmail").disabled = false;
                            if (document.getElementById("txtReiTel"))
                                document.getElementById("txtReiTel").disabled = false;
                            if (document.getElementById("cbxReiSexo"))
                                document.getElementById("cbxReiSexo").disabled = false;
                            if (document.getElementById("cbxReiFunc"))
                                document.getElementById("cbxReiFunc").disabled = false;

                            //Llenar los campos con la CCT

                            $.ajax({
                                url: "@Url.Action("ObtenerDatosCCT", "Evento")",
                                method: "POST",
                                data: { CCT: ct },
                                //datatype: "json",
                                success: function (data) {
                                    var datos = data.split("|");
                                    if (document.getElementById("txtReiRegion"))
                                        document.getElementById("txtReiRegion").value = datos[0];
                                    if (document.getElementById("txtReiPlantel"))
                                        document.getElementById("txtReiPlantel").value = datos[1];
                                    if (document.getElementById("txtReiNivel"))
                                        document.getElementById("txtReiNivel").value = datos[2];
                                    if (document.getElementById("txtReiMuni"))
                                        document.getElementById("txtReiMuni").value = datos[3];
                                    if (document.getElementById("txtReiSubsis"))
                                        document.getElementById("txtReiSubsis").value = datos[4];

                                }
                            })

                        }


                        //document.getElementById("escCCT").value = "ERROR CCT";
                    }
                });
            }

            function RegistroIndividualPartiaa(evento) {
                if (!document.getElementById("txtReiCCT")) {
                    alert("Entro"); //Si no existe entra
                }
            }

            function RegistroIndividualParti(evento) {
                $("body").css("cursor", "progress");
                document.getElementById('PopUPErrorRegistroInd').disabled = true;

                if (!document.getElementById("txtReiCCT"))
                    var txtReiCCT = "~NO+"
                else {
                    var txtReiCCT = $('#txtReiCCT').val().trim();
                    ValidarCCTRI(evento, txtReiCCT);
                }

                if (!document.getElementById("txtReiCURP"))
                    var txtReiCURP = "~NO+"
                else
                    var txtReiCURP = $('#txtReiCURP').val().trim();

                if (!document.getElementById("txtReiNom"))
                    var txtReiNom = "~NO+"
                else
                    var txtReiNom = $('#txtReiNom').val().trim();

                if (!document.getElementById("txtReiPA"))
                    var txtReiPA = "~NO+"
                else
                    var txtReiPA = $('#txtReiPA').val().trim();

                if (!document.getElementById("txtReiSA"))
                    var txtReiSA = "~NO+"
                else
                    var txtReiSA = $('#txtReiSA').val().trim();

                if (!document.getElementById("txtReiEmail"))
                    var txtReiEmail = "~NO+"
                else
                    var txtReiEmail = $('#txtReiEmail').val().trim();

                if (!document.getElementById("txtReiTel"))
                    var txtReiTel = "~NO+"
                else
                    var txtReiTel = $('#txtReiTel').val().trim();


                //Value of select sexo
                if (!document.getElementById("cbxReiSexo"))
                    var sexo = "~NO+"
                else {
                    var s = document.getElementById("cbxReiSexo");
                    var sexo = s.options[s.selectedIndex].text;
                }

                //Value of select funcion
                if (!document.getElementById("cbxReiFunc"))
                    var func = "~NO+"
                else {
                    var f = document.getElementById("cbxReiFunc");
                    var func = f.options[f.selectedIndex].text;
                }

                //Value of multiselect
                if (!document.getElementById("select1"))
                    var mesa = "~NO+"
                else {
                    var mt = document.getElementById("select1").options;
                    var met = getSelected(mt);
                    var mesa = "";
                    for (var item in met)
                        mesa += met[item].value + "|";
                }


                //alert(mesa);
                if (sexo == "" || func == "" || mesa == "" || txtReiCCT.trim() == "" || txtReiCURP.trim() == "" || txtReiNom.trim() == "" || txtReiPA.trim() == "" || txtReiSA.trim() == "" || txtReiEmail.trim() == "" || txtReiTel.trim() == "") {
                    alert("Campo obligatorio vacío");
                } else {

                     $.ajax({
                        url: "@Url.Action("RegistroIndividualParti", "Evento")",
                        method: "POST",
                         data: {e:evento, sex: sexo, fun: func, me: mesa, cct: txtReiCCT, curp: txtReiCURP, nom: txtReiNom, ap: txtReiPA, am: txtReiSA, email: txtReiEmail, tel: txtReiTel},
                        //datatype: "json",
                         success: function (data) {
                             if (isNaN(data)) {
                                 $("body").css("cursor", "default");
                                 $.ajax({
                                     url: "@Url.Action("_PopUpErrorRegistro", "Evento")",
                                     method: "POST",
                                     data: { nomE: evento, error: data},
                                     dataType: "html",
                                     success: function (response) {//PopUpErrorRegistro
                                         $('#PopUpErrorRegistro').html(response);
                                     }
                                 });
                             } else {
                                 $("body").css("cursor", "default");
                                 //alert(data); //direccionar a registro exitoso
                                 //alert("Enviar a sección correcto PDF");
                                var url = '@Html.Raw(Url.Action("RegistroExitoso", "Evento", new { nomE = "1"}))';
                                var params = url.replace('1', evento);
                                 window.location.href = params;
                                

                             }
                          document.getElementById('PopUPErrorRegistroInd').disabled = false;
                         },error: function (data) {
                             alert("Se genero un error al momento del registro.");
                             $("body").css("cursor", "default");
                             document.getElementById('PopUPErrorRegistroInd').disabled = false;
                         }
                    });
                }

            }

            function getSelected(opt) {
                var selected = new Array();
                var index = 0;
                for (var intLoop = 0; intLoop < opt.length; intLoop++) {
                    if ((opt[intLoop].selected) ||
                        (opt[intLoop].checked)) {
                        index = selected.length;
                        selected[index] = new Object;
                        selected[index].value = opt[intLoop].value;
                        selected[index].index = intLoop;
                    }
                }
                return selected;
            }


            function ValidaEmail() {
                var txtReiEmail = $('#txtReiEmail').val().trim();
                var expreg = new RegExp("^[^@@]+@@[^@@]+\.[a-zA-Z]{2,}$");

                if (expreg.test(txtReiEmail))
                    //alert("correcta");
               // document.getElementById("txtReiEmail").classList.remove('errorER');
                    document.getElementById('txtReiEmail').style.removeProperty('border');
                else {
                    document.getElementById("txtReiEmail").style.borderColor = "red";
                    //document.getElementById("txtReiEmail").value = "";
                    document.getElementById("txtReiEmail").focus();


                }
            }
            function ValidaCurpLostFocus() {
                document.getElementById("txtReiCURP").value = document.getElementById("txtReiCURP").value.toUpperCase();
                var txtReiCURP = $('#txtReiCURP').val().trim();


                var er = "[A-Z]{1}[AEIOU]{1}[A-Z]{2}[0-9]{2}" +
                    "(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1])" +
                    "[HM]{1}" +
                    "(AS|BC|BS|CC|CS|CH|CL|CM|DF|DG|GT|GR|HG|JC|MC|MN|MS|NT|NL|OC|PL|QT|QR|SP|SL|SR|TC|TS|TL|VZ|YN|ZS|NE)" +
                    "[B-DF-HJ-NP-TV-Z]{3}" +
                    "[0-9A-Z]{1}[0-9]{1}$";
                var expreg = new RegExp(er);

                if (expreg.test(txtReiCURP))
                    document.getElementById('txtReiCURP').style.removeProperty('border');
                else {
                    document.getElementById("txtReiCURP").style.borderColor = "red";
                    //document.getElementById("txtReiEmail").value = "";
                    document.getElementById("txtReiCURP").focus();


                }
            }

            function ValidaTelER() {

                var txtReiTel = $('#txtReiTel').val().trim();

                if (txtReiTel.length==10)
                    document.getElementById('txtReiTel').style.removeProperty('border');
                else {
                    document.getElementById("txtReiTel").style.borderColor = "red";
                    document.getElementById("txtReiTel").focus();
                }
            }


</script>