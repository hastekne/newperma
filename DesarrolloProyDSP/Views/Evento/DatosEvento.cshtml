@model DesarrolloProyDSP.Models.ModuloEvento.EventoViewModel
@{
    Layout = null;
    ViewBag.Title = "DatosEvento";
}

<!DOCTYPE html>

<html>
<head>

    <title>DatosEvento</title>

    @Html.Partial("../ViewPartialPrincipales/_ScriptsLink")

    <link href="@Url.Content("~/css/style.css")" rel="stylesheet" type="text/css" media="all">
    <!--pop up strat here-->
    <script src="@Url.Content("~/Scripts/jquery.magnific-popup.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.popup-with-zoom-anim').magnificPopup({
                type: 'inline',
                fixedContentPos: false,
                fixedBgPos: true,
                overflowY: 'auto',
                closeBtnInside: true,
                preloader: false,
                midClick: true,
                removalDelay: 300,
                mainClass: 'my-mfp-zoom-in'
            });

        });
    </script>

    <style>

        #loging {
            background: white;
            padding: 10px 0 10px 0;
            text-align: left;
            max-width: 629px;
            margin: 40px auto;
            position: relative;
            text-align: center;
            height: 300px;
            border-radius: 5px;
        }
        #registro {
            background: white;
            padding: 10px 0 10px 0;
            text-align: left;
            max-width: 629px;
            margin: 40px auto;
            position: relative;
            text-align: center;
            height: 300px;
            border-radius: 5px;
        }



    </style>

</head>
<body>
    <div class="page-container">
        <div class="left-content">
            <div class="mother-grid-inner">
                @Html.Partial("../ViewPartialPrincipales/_Header")



                <div class="clearfix"> </div>
            </div>
            <div class="clearfix"> </div>
        </div>
        <!--heder end here-->
        <!-- script-for sticky-nav -->
        <script>
            $(document).ready(function () {
                var navoffeset = $(".header-main").offset().top;
                $(window).scroll(function () {
                    var scrollpos = $(window).scrollTop();
                    if (scrollpos >= navoffeset) {
                        $(".header-main").addClass("fixed");
                    } else {
                        $(".header-main").removeClass("fixed");
                    }
                });

            });
        </script>
        <!-- /script-for sticky-nav -->

        <div class="inner-block" style="margin-top: -20px">
            <!--market updates updates-->


            <div class="clearfix"> </div>










            <div class="chit-chat-layer1 ">

                <div class="col-md-2 chit-chat-layer1-left ">



                </div>

                <div class="col-md-8 chit-chat-layer1-left ">
                    <div class="work-progres ">

                        <div class="table-responsive">

                            <div align="center" style="align-content: center">

                                @*<img src="@Url.Content("~/image/bannerProvicional1.jpg")" />*@
                                <img src="@Url.Action("Index","VisualizacionPrevia",new { archivo=Model.rutaIcono})" />
                            </div>

                            @if(Model.tipoEvento== "Restringido") {
                                <div align="right"> <p class="enlaces">Evento disponible solo para enlaces</p></div>
                            }



                            <div class="form-style-10" style="width: 720px; text-align:justify !important">




                                <div class="Titulo_Eventos up" align="center"><textarea rows="3" id="txtANombreE" maxlength="100" readonly="readonly" class="shadow-none">@Model.nombre</textarea></div>

                                <div class="EventoFecha">Objetivo:</div>
                                
                                <div class="objetivo" style="text-align:justify !important">
                                    </br>
                                    @*<label>Este es un texto simulado de 500 caracteres para visualizar la proporción del texto en referencia visual al diseño de la página web que se está trabajando y poder dar detalles en el proyecto en cuestión aquí se puede observar el texto de ejemplo empleado: El usuario deberá iniciar con un campo en el que se deberá capturar la CCT debe estar validada por el CEO. (Al capturar la CCT el sistema desplegará de manera automática en los siguientes campos la información de registro necesaria. Ésta info.)</label>*@
                                    <div style="pointer-events:none;">
                                        <textarea rows="8" maxlength="500" class="justificar shadow-none">@Model.objetivo</textarea>
                                    </div>
                                       
                                </div>


                                <div class="price-list">
                                    <div class="EventoF">
                                        <ul class="price-list">
                                            <li class="EventoFecha">Fecha del evento:</li>
                                            <br/>
                                            @if (Model.fVigenciaInicio.ToString("dd") != Model.fVigenciaFin.ToString("dd") && Model.fVigenciaInicio.ToString("MMM") == Model.fVigenciaFin.ToString("MMM"))
                                            {
                                                <li class="EventoDia"> <p> @Model.fVigenciaInicio.ToString("dd") <span>al</span> @Model.fVigenciaFin.ToString("dd")</p></li>
                                                <li class="EventoMes">@Model.fVigenciaInicio.ToString("MMMM").ToUpper()</li>
                                            }
                                            else if ((Model.fVigenciaInicio.ToString("dd") == Model.fVigenciaFin.ToString("dd") || Model.fVigenciaInicio.ToString("dd") != Model.fVigenciaFin.ToString("dd")) && Model.fVigenciaInicio.ToString("MMM") != Model.fVigenciaFin.ToString("MMM"))
                                            {
                                                <li class="EventoDia"> <p> @Model.fVigenciaInicio.ToString("dd") <span>al</span> @Model.fVigenciaFin.ToString("dd")</p></li>
                                                <li class="EventoMes">@Model.fVigenciaInicio.ToString("MMMM").ToUpper() - @Model.fVigenciaFin.ToString("MMMM").ToUpper()</li>
                                            }
                                            else if (Model.fVigenciaInicio.ToString("dd") == Model.fVigenciaFin.ToString("dd") && Model.fVigenciaInicio.ToString("MMM") == Model.fVigenciaFin.ToString("MMM"))
                                            {
                                                <li class="EventoDia"> <p> @Model.fVigenciaInicio.ToString("dd") </p></li>
                                                <li class="EventoMes">@Model.fVigenciaInicio.ToString("MMMM").ToUpper()</li>
                                            }


                                        </ul>
                                    </div>

                                </div>


                                
                                <div class="compose-block" style="background: none">
                                    <a id="registroE" class="popup-with-zoom-anim"  onclick="RegistrarEvento('@Model.tipoEvento','@Model.nombre')" style="width: 100%">Registrarse</a>
                                </div>



                            </div>

                        </div>
                    </div>
                </div>




                <div id="popup">
                    <div id="registro" class="mfp-hide"  >
                        <div class="pop_up" >
                            <div class="payment-online-form-left">
                                <form>

                                    <h4>Inicio de sesión</h4>


                                    <ul>
                                        <li><input id="txtUserEnlace" name="txtUser" class="text-box-dark" type="text" value="Usuario" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Usuario';}" style="width: 100%;"></li>
                                        <li><input id="txtPassEnlace" name="txtPass" class="text-box-dark" type="password" value="Contraseña" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Contraseña';}" style="width: 100%"></li>
                                    </ul>






                                    @*<ul class="payment-sendbtns">

            <li><input type="button" value="Registrarte" onclick="location.href='@Url.Action("Registro","Usuario")'"></li>


        </ul>*@

                                    <a onclick="IniciarSesionEnlace('@Model.nombre')"  class="order" style="width: 100%;">Iniciar sesión</a>
                                   
                                </form>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="col-md-2 chit-chat-layer1-rit">

                </div>
                <div class="clearfix"> </div>
            </div>


        </div>


        <!--inner block end here-->
        <!--copy rights start here-->
        @Html.Partial("../ViewPartialPrincipales/_Footer")
        <div class="clearfix"> </div>

        <!--slide bar menu end here-->
        <!--scrolling js-->
        <script src="Administrador/js/jquery.nicescroll.js"></script>
        <script src="Administrador/js/scripts.js"></script>
        <!--//scrolling js-->
        <script src="Administrador/js/bootstrap.js"></script>
        <!-- mother grid end here-->


    </div>

    </div>

</body>

</html>
<script type="text/javascript">
   
    function RegistrarEvento(tipoEvento,nomEv) {
        if (tipoEvento == "Restringido") {
            //document.getElementById("registroE").removeAttribute("href");
            $.ajax({
        type: "POST",
        url: '@Url.Action("SesionEnlaceActiva", "Evento")', // don't hard code url's
            //data: { userName: $('#txtUserEnlace').val(), pass: $('#txtPassEnlace').val()},
       // dataType: "html",
             success: function (data) // lowercase (not Success)
            {
                 
                 if (data == "false") {
                     document.getElementById("registroE").href = "#registro"; //Para mostrar el popUp si no se ha iniciado sesión
                 } else {
                     //document.getElementById("registroE").href = "#";
                     
                     //alert("Usuario Enlace Logeado, enviar a pagina");
                     var url = "@Url.Action("Registrar", "Evento", new { nomE = "nombreEvento" })";
                     url = url.replace("nombreEvento", nomEv);
                     window.location.assign(url);
                 }
                 

             },
             error: function (data) {
                alert("Error al validar Sesión Activa.");
            }
        });

            
        } else {
            //alert("enviar a la proxima ventana, Evento publico");
             var url = "@Url.Action("Registrar", "Evento", new { nomE = "nombreEvento" })";
                     url = url.replace("nombreEvento", nomEv);
                     window.location.assign(url);
        }
        
        
    }

    function IniciarSesionEnlace(nomEv) {
        //var nomEv = documento.getElementById('txtANombreE').value;
        $.ajax({
        type: "POST",
        url: '@Url.Action("ValidaInicioSesionEnlace", "Usuario")', // don't hard code url's
            data: { userName: $('#txtUserEnlace').val(), pass: $('#txtPassEnlace').val()},
       // dataType: "html",
             success: function (data) // lowercase (not Success)
            {
                 
                 if (data != "Enlace") {
                     alert("Usuario o contraseña incorrectos. Evento solo para Enlaces");
                 } else {
                     //alert("Inicio enlace correcto, Enviar a siguiente vista");//
                      var url = "@Url.Action("Registrar", "Evento", new { nomE = "nombreEvento" })";
                     url = url.replace("nombreEvento", nomEv);
                     window.location.assign(url);
                 }
                 

             },
             error: function (data) {
                alert("Error al Iniciar Sesión");
            }
        });
    }

</script>